# Отчёт по выполнению практической работы № 6

### Информация о студенте
* **Студент:** Островский Антон Ильич
* **Группа:** БСБО-09-22
* **Номер по списку:** 20

---

## Тема: Работа с Фрагментами в Android. Навигация и обмен данными.

## Цель работы:
*   Изучить концепцию **Фрагментов (`Fragment`)**, их жизненный цикл и преимущества в построении гибких и адаптивных пользовательских интерфейсов.
*   Освоить **`FragmentManager`** для выполнения транзакций с фрагментами: добавление, замена, использование обратного стека (`back stack`).
*   Изучить и применить на практике основные способы обмена данными между компонентами:
    *   Передача данных в фрагмент через `Bundle`.
    *   Взаимодействие между фрагментами с помощью **`Shared ViewModel`**.
    *   Передача результата с помощью **`Fragment Result API`**.
*   Интегрировать полученные знания в основной проект (`HabitTracker`), реализовав новый раздел "Профиль" на основе фрагментов.

---

## Ход работы:

В рамках практической работы было выполнено несколько подготовительных заданий в изолированных модулях для изучения ключевых технологий, после чего полученные знания были применены для расширения функциональности основного проекта `HabitTracker`.

### 1. Задание `FragmentApp`: Основы и передача данных

**Задача:** Создать модуль с одним фрагментом и передать в него данные (номер по списку) из родительской `Activity`.

**Реализация:**
1.  Был создан модуль `FragmentApp` и добавлен `BlankFragment`.
2.  В `MainActivity` был создан `Bundle`, в который было помещено число `20`.
3.  С помощью `getSupportFragmentManager()` была выполнена транзакция, которая добавила `BlankFragment` в `FragmentContainerView`, передав ему созданный `Bundle`.
4.  Во фрагменте, в методе `onViewCreated`, данные были получены через `getArguments()` и отображены в `TextView`.


<img width="1919" height="1036" alt="image" src="https://github.com/user-attachments/assets/4cf785d0-9461-454b-9902-c8c2bd022786" />


### 2. Задание `FragmentManagerApp`: Взаимодействие через `Shared ViewModel`

**Задача:** Создать экран, состоящий из двух фрагментов (список и детали), и реализовать их взаимодействие.

**Реализация:**
1.  Был создан модуль `FragmentManagerApp`.
2.  Реализованы `ListFragment` (с кнопками) и `DetailsFragment` (с `TextView`).
3.  Создан класс `SharedViewModel`, содержащий `MutableLiveData` для хранения выбранного элемента.
4.  Оба фрагмента получили доступ к **одному и тому же экземпляру** `SharedViewModel`, указав в качестве владельца `requireActivity()`.
5.  `ListFragment` при нажатии на кнопку **записывал** данные в `ViewModel`.
6.  `DetailsFragment` был **подписан** (`observe`) на `LiveData` в `ViewModel` и автоматически обновлял свой `TextView` при изменении данных.


<img width="491" height="925" alt="image" src="https://github.com/user-attachments/assets/5660e2e3-0adc-4ac6-9bc6-a18c0831307b" />

<img width="499" height="927" alt="image" src="https://github.com/user-attachments/assets/5231d814-498b-4afd-91f3-225d558e4616" />

<img width="488" height="922" alt="image" src="https://github.com/user-attachments/assets/3bca1afd-6e0d-46b9-b1b6-08a5a2dadc5f" />


### 3. Задание `ResultApiFragmentApp`: Передача результата

**Задача:** Реализовать передачу данных из одного фрагмента в другой с помощью `Fragment Result API`.

**Реализация:**
1.  Был создан модуль `ResultApiFragmentApp`.
2.  Реализован `DataFragment` (с полем ввода) и `BottomSheetResultFragment` (диалоговый фрагмент).
3.  `BottomSheetResultFragment` устанавливал "слушателя" результата с помощью `setFragmentResultListener`.
4.  `DataFragment` при нажатии на кнопку устанавливал результат с помощью `setFragmentResult` с тем же ключом, после чего отображал `BottomSheetResultFragment`.
5.  `FragmentManager` автоматически передавал установленный результат слушателю, и данные отображались в диалоге.


<img width="475" height="919" alt="image" src="https://github.com/user-attachments/assets/d838301d-82aa-4c8f-bda9-784721aacad7" />


### 4. Контрольное задание: Интеграция в `HabitTracker`

**Задача:** Реализовать в основном проекте `HabitTracker` новый раздел "Профиль" с использованием фрагментов, навигации и `back stack`.

**Реализация:**
Было принято архитектурное решение **не изменять существующую рабочую логику**, а добавить новый функционал в виде **отдельного, изолированного экрана**.

1.  **Создан новый экран:** Добавлена новая `ProfileActivity`, которая выступает в роли хоста для фрагментов. На `MainActivity` добавлена иконка в `Toolbar`, открывающая этот экран.
2.  **Реализована навигация:** В `ProfileActivity` добавлена `BottomNavigationView` для переключения между двумя фрагментами: `ProfileFragment` и `SettingsFragment`.
3.  **Использован `FragmentManager`:** Переключение между фрагментами реализовано с помощью транзакций `replace()`. Каждая транзакция добавляется в `back stack` с помощью `addToBackStack(null)`, что позволяет корректно работать системной кнопке "Назад".
4.  **Отображение данных:** `ProfileFragment` реализован так, что он загружает и отображает email текущего авторизованного пользователя из `SharedPreferences`.


<img width="489" height="928" alt="image" src="https://github.com/user-attachments/assets/b257fdd8-f402-4cca-896e-8545bd82541f" />


---

## Общие выводы:

В ходе выполнения последней практической работы были успешно освоены ключевые концепции современной Android-разработки: Фрагменты, их жизненный цикл, `FragmentManager` и паттерны обмена данными (`Shared ViewModel`, `Fragment Result API`).
